# Configuration for model evaluation with spatial analysis

# Data configuration
data:
  # Data path will be specified via command line
  target_column: "vhm0_y" # Target column name (currently hardcoded in code)
  # Local model path example:
  # model_path: "/Users/deeplab/Documents/projects/hcmr/data/experiments/20250921_2203_xgb_500K_samples_basin/"
  # S3 model path example (when s3.enabled: true):
  model_path: "s3://medwav-dev-data/experiments/full_dataset_experiment/xgb_1000K_samples_per_point_stratified_no_early_stopping_all_extremes_20251005_224846/model"

  # Local data path example:
  # data_path: "/Users/deeplab/Documents/projects/hcmr/data/hourly"
  # S3 data path example (when s3.enabled: true):
  data_path: "s3://medwav-dev-data/parquet/hourly/"
  file_pattern: "*.parquet"

# Feature configuration (synchronized with training pipeline)
feature_block:
  predict_bias: true # Set to true to predict bias
  # Features to exclude from the feature set
  features_to_exclude:
    - "corrected_VTM02"
    - "time"
    - "lat"
    - "lon"
    - "latitude"
    - "longitude"
    - "WDIR"
    - "VMDR"

  # Geographic context features
  use_geo_context:
    enabled: false # Set to true to enable geographic context features
    include_basin: false # Include basin categorical feature (0=Atlantic, 1=Mediterranean, 2=Eastern Med)

  # Lag features for temporal patterns
  lag_features:
    enabled: false # Set to true to enable lag features
    lags:
      vhm0_x: [1, 3, 6] # Lag hours for significant wave height
      wspd: [1, 3, 6] # Lag hours for wind speed
      vtm02: [1, 3, 6] # Lag hours for wave period
      wdir: [1, 3, 6] # Lag hours for wind direction
      vmdr: [1, 3, 6] # Lag hours for wave direction

  # Regional training (filter to specific regions)
  regional_training:
    enabled: false # Set to true to enable regional training
    training_regions: [0] # Regions to include in training: [0] (atlantic), [1] (mediterranean), [2] (eastern_med)

  # Sea-bin metrics for performance analysis across wave height ranges
  sea_bin_metrics:
    enabled: true # Set to true to enable sea-bin metrics
    bins:
      - name: "calm"
        min: 0.0
        max: 1.0
        description: "Calm conditions"
      - name: "light"
        min: 1.0
        max: 2.0
        description: "Light seas"
      - name: "moderate"
        min: 2.0
        max: 3.0
        description: "Moderate seas"
      - name: "rough"
        min: 3.0
        max: 4.0
        description: "Rough seas"
      - name: "very_rough"
        min: 4.0
        max: 5.0
        description: "Very rough seas"
      - name: "high"
        min: 5.0
        max: 6.0
        description: "High seas"
      - name: "very_high"
        min: 6.0
        max: 7.0
        description: "Very high seas"
      - name: "phenomenal_1"
        min: 7.0
        max: 8.0
        description: "Phenomenal seas"
      - name: "extreme_1"
        min: 8.0
        max: 9.0
        description: "Extreme seas"
      - name: "phenomenal_2"
        min: 9.0
        max: 10.0
        description: "Phenomenal seas"
      - name: "extreme_2"
        min: 10.0
        max: 11.0
        description: "Extreme seas"
      - name: "phenomenal_3"
        min: 11.0
        max: 12.0
        description: "Phenomenal seas"
      - name: "extreme_3"
        min: 12.0
        max: 13.0
        description: "Extreme seas"
      - name: "phenomenal_4"
        min: 13.0
        max: 14.0
        description: "Phenomenal seas"
      - name: "extreme_4"
        min: 14.0
        max: 15.0
        description: "Extreme seas"

# Evaluation configuration
evaluation:
  year: "2023"
  max_files: null # Process all December 2023 files (31 days) for faster evaluation
  max_workers: 1 # Number of parallel workers for file evaluation (set to 1 for sequential, 4+ for parallel)

  # Temporal analysis
  temporal_analysis:
    enabled: true # Let users skip temporal analysis
    daily_metrics: true
    monthly_metrics: true
    seasonal_metrics: true
    create_plots: true

  # Plot settings (currently hardcoded in code)
  plots:
    marker_size: 8
    alpha: 0.85
    colormap: "RdYlBu_r"
    metrics_to_plot: ["bias", "mae", "rmse", "diff"]

# S3 configuration for model loading and results saving
s3:
  enabled: true # Set to true to enable S3 saving
  bucket: "medwav-dev-data" # S3 bucket name
  region: "eu-central-1" # AWS region
  aws_profile: null # AWS profile name (optional, uses default if null)

# Output configuration
output:
  output_dir: "evaluation_results"

  s3:
    enabled: true # Set to true to enable S3 saving
    bucket: "medwav-dev-data" # S3 bucket name
    prefix: "experiments/full_dataset_experiment/xgb_1000K_samples_per_point_stratified_no_early_stopping_all_extremes_20251005_224846/evaluation_results" # S3 prefix for organizing results
    region: "eu-central-1" # AWS region
    aws_profile: null # AWS profile name (optional, uses default if null)

# Parallel processing configuration
parallel_processing:
  enabled: false # Re-enable parallel processing for speed
  n_workers: 4 # Use 4 workers for processing all 365 files
  batch_size: 8 # Process 10 files per batch for efficiency
  use_multiprocessing: false # Use ProcessPoolExecutor for true parallelism
  max_workers: 6 # Maximum number of workers

# Training diagnostics
diagnostics:
  enabled: true
  plots_save_path: "evaluation_results/diagnostic_plots"
  save_training_history: false
  create_learning_curves: false
  create_residual_plots: false
  create_prediction_plots: false
  create_regional_analysis: true # Enable regional performance analysis plots
  create_sea_bin_analysis: true # Enable sea-bin performance analysis plots
  create_spatial_maps: false
  create_regional_error_box_plots: false
  create_wave_height_performance_plots: true
  create_snr_comparison_plot: false
